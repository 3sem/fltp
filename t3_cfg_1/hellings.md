
Получили какой-то путь на текущем шаге. Нужно попробовать приконкатенировать к нему какую-то из существовавших ранее подцепочек слева, и справа.

Храним не матрицу в явном виде, а рабочее множество.
